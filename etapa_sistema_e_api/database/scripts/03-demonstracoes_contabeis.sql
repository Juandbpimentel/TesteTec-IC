
        CREATE OR REPLACE FUNCTION load_from_gcs_demonstracoes_contabeis(url TEXT) RETURNS VOID AS $$
        BEGIN
            EXECUTE format(
                $CMD$
                COPY demonstracoes_contabeis (registro_operadora, cd_conta_contabil, descricao, vl_saldo_inicial, vl_saldo_final, data_demonstracao, trimestre, ano) FROM PROGRAM 'curl -sL %s | lz4 -d'
                WITH (
                    FORMAT CSV,
                    DELIMITER ';',
                    HEADER,
                    NULL ''
                    
                )
                $CMD$,
                url
            );
        END;
        $$ LANGUAGE plpgsql;

SELECT load_from_gcs_demonstracoes_contabeis('https://storage.googleapis.com/testetecnico-ic.firebasestorage.app/demonstracoes_contabeis/part-0024.csv.lz4');SELECT load_from_gcs_demonstracoes_contabeis('https://storage.googleapis.com/testetecnico-ic.firebasestorage.app/demonstracoes_contabeis/part-0001.csv.lz4');SELECT load_from_gcs_demonstracoes_contabeis('https://storage.googleapis.com/testetecnico-ic.firebasestorage.app/demonstracoes_contabeis/part-0013.csv.lz4');SELECT load_from_gcs_demonstracoes_contabeis('https://storage.googleapis.com/testetecnico-ic.firebasestorage.app/demonstracoes_contabeis/part-0014.csv.lz4');SELECT load_from_gcs_demonstracoes_contabeis('https://storage.googleapis.com/testetecnico-ic.firebasestorage.app/demonstracoes_contabeis/part-0006.csv.lz4');SELECT load_from_gcs_demonstracoes_contabeis('https://storage.googleapis.com/testetecnico-ic.firebasestorage.app/demonstracoes_contabeis/part-0016.csv.lz4');SELECT load_from_gcs_demonstracoes_contabeis('https://storage.googleapis.com/testetecnico-ic.firebasestorage.app/demonstracoes_contabeis/part-0011.csv.lz4');SELECT load_from_gcs_demonstracoes_contabeis('https://storage.googleapis.com/testetecnico-ic.firebasestorage.app/demonstracoes_contabeis/part-0003.csv.lz4');SELECT load_from_gcs_demonstracoes_contabeis('https://storage.googleapis.com/testetecnico-ic.firebasestorage.app/demonstracoes_contabeis/part-0023.csv.lz4');SELECT load_from_gcs_demonstracoes_contabeis('https://storage.googleapis.com/testetecnico-ic.firebasestorage.app/demonstracoes_contabeis/part-0020.csv.lz4');SELECT load_from_gcs_demonstracoes_contabeis('https://storage.googleapis.com/testetecnico-ic.firebasestorage.app/demonstracoes_contabeis/part-0015.csv.lz4');SELECT load_from_gcs_demonstracoes_contabeis('https://storage.googleapis.com/testetecnico-ic.firebasestorage.app/demonstracoes_contabeis/part-0000.csv.lz4');SELECT load_from_gcs_demonstracoes_contabeis('https://storage.googleapis.com/testetecnico-ic.firebasestorage.app/demonstracoes_contabeis/part-0018.csv.lz4');SELECT load_from_gcs_demonstracoes_contabeis('https://storage.googleapis.com/testetecnico-ic.firebasestorage.app/demonstracoes_contabeis/part-0005.csv.lz4');SELECT load_from_gcs_demonstracoes_contabeis('https://storage.googleapis.com/testetecnico-ic.firebasestorage.app/demonstracoes_contabeis/part-0010.csv.lz4');SELECT load_from_gcs_demonstracoes_contabeis('https://storage.googleapis.com/testetecnico-ic.firebasestorage.app/demonstracoes_contabeis/part-0004.csv.lz4');SELECT load_from_gcs_demonstracoes_contabeis('https://storage.googleapis.com/testetecnico-ic.firebasestorage.app/demonstracoes_contabeis/part-0009.csv.lz4');SELECT load_from_gcs_demonstracoes_contabeis('https://storage.googleapis.com/testetecnico-ic.firebasestorage.app/demonstracoes_contabeis/part-0008.csv.lz4');SELECT load_from_gcs_demonstracoes_contabeis('https://storage.googleapis.com/testetecnico-ic.firebasestorage.app/demonstracoes_contabeis/part-0022.csv.lz4');SELECT load_from_gcs_demonstracoes_contabeis('https://storage.googleapis.com/testetecnico-ic.firebasestorage.app/demonstracoes_contabeis/part-0002.csv.lz4');SELECT load_from_gcs_demonstracoes_contabeis('https://storage.googleapis.com/testetecnico-ic.firebasestorage.app/demonstracoes_contabeis/part-0017.csv.lz4');SELECT load_from_gcs_demonstracoes_contabeis('https://storage.googleapis.com/testetecnico-ic.firebasestorage.app/demonstracoes_contabeis/part-0021.csv.lz4');SELECT load_from_gcs_demonstracoes_contabeis('https://storage.googleapis.com/testetecnico-ic.firebasestorage.app/demonstracoes_contabeis/part-0007.csv.lz4');SELECT load_from_gcs_demonstracoes_contabeis('https://storage.googleapis.com/testetecnico-ic.firebasestorage.app/demonstracoes_contabeis/part-0019.csv.lz4');SELECT load_from_gcs_demonstracoes_contabeis('https://storage.googleapis.com/testetecnico-ic.firebasestorage.app/demonstracoes_contabeis/part-0012.csv.lz4');